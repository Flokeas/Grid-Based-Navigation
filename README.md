You can see the codes in top down controller file
Sorry that it's a little messy.
